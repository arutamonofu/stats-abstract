
![[hg.png]]

# Основные свойства

| Свойство                       | Значение                                                                                       |
| ------------------------------ | ---------------------------------------------------------------------------------------------- |
| Нотация                        | $X \sim HG(D, N, n)$                                                                           |
| Параметры                      | $D$ — число «успешных» объектов в ГС, $N$ — размер ГС, $n$ — число испытаний (размер выборки). |
| Определение случайной величины | Число «успехов» в $n$ зависимых испытаниях (без возвращения).                                  |
| Тип исходных данных            | Бинарный категориальный                                                                        |
| Тип случайной величины         | Дискретный                                                                                     |

# Функции

| Функция                     | Формула                                                                                 |
| --------------------------- | --------------------------------------------------------------------------------------- |
| Функция вероятности (PMF)   | $P(X = k) = \frac {C_{D}^k C_{N-D}^{n-k}}{C_{N}^n}$                                     |
| Функция распределения (CDF) | $P(X \leq y) = \sum_{k = 0}^{\lfloor y \rfloor} \frac {C_{D}^k C_{N-D}^{n-k}}{C_{N}^n}$ |

- $C_{n}^k$ — биномиальный коэффициент, или число сочетаний из $n$ по $k$

# Аппроксимация

| Условие                                         | Распределение                                                                  |
| ----------------------------------------------- | ------------------------------------------------------------------------------ |
| $N \to \infty, D \to \infty, \frac{N}{D} \to p$ | [[Распределение биномиальное\|Биномиальное]]: $B\left( n, \frac{D}{N} \right)$ |

# Пример

Магазин электроники продаёт 300 ноутбуков за неделю. Из них по итогам прошлых продаж известно, что 60 ноутбуков были возвращены покупателями по различным причинам (например, брак или неудовлетворённость). Для проверки уровня удовлетворённости клиентов менеджер выбирает 15 ноутбуков из партии, чтобы изучить случаи возвратов. Какова вероятность того, что в выборке окажется не менее 5 возвращённых ноутбуков?

$X \sim HG(60, 300, 15) \implies P(X \geq 5) = 1 - P(X \leq 4) =  1 - \sum_{k = 0}^{\lfloor 4 \rfloor} \frac {C_{60}^{k} C_{300-60}^{15-k}}{C_{300}^{15}} \approx 0.16$

![[hg_sf.png]]

```python
import numpy as np
import scipy.stats as sps

d = 60
n = 300
sample_size = 15
k = 5

s = sps.hypergeom.sf(k - 1, n, d, sample_size)
print(s)
```